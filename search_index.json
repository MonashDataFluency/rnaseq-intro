[
["index.html", "Introduction to RNAseq Introduction to RNAseq", " Introduction to RNAseq Version 1 Introduction to RNAseq These are course notes for the “Introduction to RNAseq” course given by the Monash Bioinformatics Platform for the Monash Data Fluency initiative. Our teaching style is based on the style of The Carpentries. PDF version for printing Source code GitHub page Authors and copyright This course is developed for the Monash Bioinformatics Platform by Stuart Archer, Nick Wong and Kirill Tsyganov. This work is licensed under a CC BY-4: Creative Commons Attribution 4.0 International License. The attribution is “Monash Bioinformatics Platform” if copying or modifying these notes. "],
["genomics.html", "1 Genomics 1.1 Sequence 1.2 Read sequence 1.3 Contig sequence 1.4 Summary", " 1 Genomics Genome is a collection of all genetic material in the organism. To be more accurate each cell in our body contains a copy of entire genome. The study of genomics is all things to do with genome including gene expression, methylation profiles, transcriptional factor binding, chromatic arrangements and three dimensional structure of chromosomes and many more things. In this course we are going to focus on one particular technique of genomics - RNA sequencing or RNAseq for short. This is a study of primarily but not limited to gene expression. Other common application of RNAseq are study of splicing and isoforms. In genomics everything rotates around sequence information, let’s look into biological sequence next. 1.1 Sequence A sequence is a generic name describing the order of biological letters in molecules like DNA, RNA or piptide and protein. In the case of DNA and RNA letters mean nucleotide bases, Adenine, Thymine, Cytosine Guanine or ATCG for short. Also know that mRNA contains Uracil instead of Thymine. This would be one way to represent all five possible bases A[T|U]CG In the case of piptide/protein molecules each letter means amino acid type, I won’t list discuss proteins any further in this book since it isn’t a focus on this book. Note that there is a greater nomenclature exists to cover all possible variances ## Letter_code Base_name ## 1 A Adenine ## 2 C Cytosine ## 3 G Guanine ## 4 T|U Thymine|Uracil ## 5 R A|G ## 6 Y C|T ## 7 S G|C ## 8 W A|T ## 9 K G|T ## 10 M A|C ## 11 B C|G|T ## 12 D A|G|T ## 13 H A|C|T ## 14 V A|C|G ## 15 N any base The reason we have sequence information of any kind is because someone somewhere made an afford to sequence some part of the molecule. In the case of whole genome sequencing an afford was made to sequence the entire genome, for human the entire genome is 3 billion bases long. However this is a sum of all bases across all chromosomes, but chromosomes are not all equal, below is a sequence lenght of each chromosome. ## Chrom Length ## 1 1 248956422 ## 2 2 242193529 ## 3 3 198295559 ## 4 4 190214555 ## 5 5 181538259 ## 6 6 170805979 ## 7 7 159345973 ## 8 8 145138636 ## 9 9 138394717 ## 10 10 133797422 ## 11 11 135086622 ## 12 12 133275309 ## 13 13 114364328 ## 14 14 107043718 ## 15 15 101991189 ## 16 16 90338345 ## 17 17 83257441 ## 18 18 80373285 ## 19 19 58617616 ## 20 20 64444167 ## 21 21 46709983 ## 22 22 50818468 ## 23 X 156040895 ## 24 Y 57227415 ## 25 MT 16569 While sequence is a generic name and often times it needs some context around it, for example DNA sequence, RNA sequence or chromosome 3 sequence. There are other names like contig and a read, which are both sequences too, they mean more specific thing. In general both mean shorter sequence, where contig almost always should be longer then a read. Let’s talk about a read sequence next. 1.2 Read sequence A read is product of a machine read out that takes some biological material i.e DNA or RNA sample and produces number of reads that resembles what you’ve put into the machine. There have been a few iteration of sequencing technologies, each iteration brings about higher yield (more reads) and longer reads. Current players in the genomics space are: Short read technologies Illumina MiSeq HiSeq NextSeq NovaSeq BGI platforms BGISEQ-50 BGISEQ-500 Ion Torrent Medium to long read technologies PacBio Sequel System Oxford Nanopore MinION GridION PromethION All of the above technologies will one way or another result in digital reads. As name implies short reads are typically 50-300 bases, whereas long reads can range from 1k to 10k or more. Usually the quantity and the length of the read are inversely proportional, however the throughput of a short reads technology at the moment is vastly greater then the long read and it doesn’t suffer from the coverage issue. In terms of number of reads we are talking about millions to billions for short reads technology and in the range of 1 to 4 millions for long reads. This is a good plot showing nanopore output, which illustrates quantity vs length nicely. Figure 1.1: https://bioinformatics.stackexchange.com/questions/3623/how-many-reads-has-my-sequencing-run-produced-on-minion Getting the reads is just a first step. You have to do something with your reads. The two path one can take are really assemble your reads into contigs and further into full genome or map your reads to an existing reference genome. In this course we’ll be taking the later path - mapping our RNAseq reads to an existing reference genome. But let me just talk a little more about what a contig sequence is next. 1.3 Contig sequence Contig has specific meaning in genome assembly. It is a larger fragment assembled from short (100-300 bp) reads that hasn’t yet been merged into chromosome. However often times this term can be loosely used to mean any long stretch of sequence. I often (incorrectly) refer to chromosomes as different contigs in the FASTA file. With long read technologies advancing pretty rapidly it breaks conventional definitions of a read and contig, where a single read can be longer then a contig. However assembling two long reads would still result in a contig sequence. So once again it is important to give more context when using this term. 1.4 Summary Genomics is all things genome that rotates around genomic sequence Sequence is an ordered collection of nucleotide bases Read is an output from a sequencing machine that covered biological sample in digital sequence RNAseq focuses on gene expression and splicing isoforms "],
["bioinformatics-file-formats.html", "2 Bioinformatics file formats 2.1 Introduction 2.2 What is a file format? 2.3 Annotation files 2.4 Plain text files 2.5 Glossary", " 2 Bioinformatics file formats Before diving into specific file formats. I would like to discuss what could file actually mean and hold in general, after all bioinformatics files aren’t that different form any other files. In fact fair number of bioinformatics files are just a variant of TSV file format, discussed shortly. Bioinformatics world largely rotates around Unix/Linux ecosystem, and remember that macOS is Unix derived operating system too. That means that a lot of the tooling and compute happens on linux computers often referred to as servers. In unix world file name is simply a string of letters (text) that points to a location of that file content that is stored elsewhere. Therefore the only thing that matters for file names is they are unique. Often people get caught out by file’s extensions, they do not matter. File extentions are simply an indicator for a user what to expect when they are going to open that file. To more accurate other programs often look at file extensions too trying to guess if this is the file format they can handle. In general it is a very good idea to have correct file extension. I just want you to know that just because you’ve renamed a file from ref.fasta to ref.fa nothing had happened to it content. Bioinformatics is an evolving field and new technologies will bring about new file formats. 2.1 Introduction Broadly speaking any computer file is either a plain text or binary format. Under the hood everything is binary of course, but a plain text file can be looked at and modified using standard unix/linux tool sets as well simply opened with any text editor for more custom modification. If the file isn’t plain text you have to have specific tool to work with that file type. For example pdf files aren’t plain text and this is why you need pdf viewer (e.g adobe reader) to work with pdfs. Similarly in bioinformatics BAM files aren’t plain text and do require samtools to work with it. As I’ve hinted earlier large number of bioinformatics files are plain text, however a lot of the times plain text files are ziped with gzip tool adding another suffix to the file name and thereby changing the file into binary for that now will require gzip tool to work with. We zip file to reduce they size. Zipping works particular well on files that have repetitive patterns e.g repeats of ATCG sequence. Note the difference in size is essentially three times ! -rw-r--r-- 1 kirill kirill 3.0G Apr 10 10:11 Homo_sapiens.GRCh38.dna_sm.removed_contigs.fa -rw-r--r-- 1 kirill kirill 895M Apr 10 10:10 Homo_sapiens.GRCh38.dna_sm.removed_contigs.fa.gz It is a natural behaviour wanting to unzip file before looking inside. It is okay to do so, but be aware that this isn’t the best practice, and you don’t want to be storing your files in plain text for a long time, this will eat up your disk space very quickly. example of large BAM file and plain text SAM Remember that best practice is always keep your files zipped Let’s talk next about what makes different file formats different 2.2 What is a file format? The file format at it simplest defines structure with in the file. By far the most common structure of the plain text file is tabular. The spreadsheet that everyone is so familiar with is simply a plain text file with rows and columns, where each cell separated by a “special” character called tabular or tab for short, which makes tab separated variables file or tsv for short with a sister file of comma separated variables or csv for short where instead of tab character comma is used. Comma Separated Variables (csv) Gene.ID Chrom Gene.Name Biotype KO3_S3 KO4_S4 WT1_S1 WT2_S2 ENSMUSG00000051951 1 Xkr4 protein_coding 0 0 0 0 ENSMUSG00000025900 1 Rp1 protein_coding 0 0 0 0 ENSMUSG00000109048 1 Rp1 protein_coding 0 0 0 0 ENSMUSG00000025902 1 Sox17 protein_coding 0 0 0 0 ENSMUSG00000033845 1 Mrpl15 protein_coding 934 1317 888 939 ENSMUSG00000025903 1 Lypla1 protein_coding 705 848 647 747 ENSMUSG00000104217 1 Gm37988 protein_coding 0 0 0 0 ENSMUSG00000033813 1 Tcea1 protein_coding 354 436 368 442 ENSMUSG00000002459 1 Rgs20 protein_coding 0 0 0 0 Tab Separated Variables (tsv) Gene.ID,Chrom,Gene.Name,Biotype,KO3_S3,KO4_S4,WT1_S1,WT2_S2 ENSMUSG00000051951,1,Xkr4,protein_coding,0,0,0,0 ENSMUSG00000025900,1,Rp1,protein_coding,0,0,0,0 ENSMUSG00000109048,1,Rp1,protein_coding,0,0,0,0 ENSMUSG00000025902,1,Sox17,protein_coding,0,0,0,0 ENSMUSG00000033845,1,Mrpl15,protein_coding,934,1317,888,939 ENSMUSG00000025903,1,Lypla1,protein_coding,705,848,647,747 ENSMUSG00000104217,1,Gm37988,protein_coding,0,0,0,0 ENSMUSG00000033813,1,Tcea1,protein_coding,354,436,368,442 ENSMUSG00000002459,1,Rgs20,protein_coding,0,0,0,0 Common bioinformatics files such gff/gtf, bed and vcf are all variant of tsv in some respect except with defined column names and hence value types that can fit in those columns. I haven’t explained what each of those files used for. Let’s focus on gff/gtf format only and leave the other two for later discussion. 2.3 Annotation files The essence of annotation file, guessable from the name, is to provide information of coordinates of features in the genome. A feature could mean several things including a gene, transcript, exon, 3’UTR or any other region of the gnome that is “worth” documenting. Basically this is your google map without pictures. If you think about what information would you need in order to identify a gene for example well known tumor suppressor gene TP53. bear minimum we need to know which chromosome it is one where about it is on chromosome 17 remember that humans are diploid - which strand of chromosome 17 it is on In a simply tabular format this would look like this tp53 chr17 7661779 7687550 + Turns out that this is actually is an annotation file format called Simplified Annotation Format (SAF). It isn’t that widely used, because it has some limitations, which is outside of the course to discuss and there are at least three other annotation formats that exist, which we not going to discuss any further. Side tracking to our earlier discussion about file extensions, saf is a file format given that it has defined structure, but what should the extension be? Anything you like .txt because it is a text file, .tsv well it is tab separated. I usually do .saf, because that tells me straight away exactly what the content of the file is. This is what file extension supposed to do. The file format that we are going to focus on is General Feature Format (gff) Plain text file format The format was proposed as a means to transfer feature information We do not intend GFF format to be used for complete data management of the analysis and annotation of genomic sequence Originally wanted file format that will be easily parsable by Unix tools such grep, sort and awk For the purpose of understanding RNAseq experiment the bear minimum you’ll need to understand are these three file types: FASTQ FASTA GFF/GTF 2.3.0.1 FASTQ This is a very important file(s) you don’t mess directly with FASTQ files. Best not to every unzip those either. If think that you need to do some thing fastq files in terms of editing or some other out of ordinary manipulations. Make a copy and work on the copy. If you modify, corrupt or loose your FASTQ files, days, month or year of wet-lab work go down a toilet, let a lone large sum of money spend on RNA extraction, library prepartion and sequencing. 2.3.0.2 FASTA There are a few different fasta files, but all of them will hold some sort of sequence. Sometime you’ll see .fna to inidicate nuclear sequence or .faa to indicate amino acid sequence, but more generally it’ll be .fa or a longer version .fasta. Like any biological plain text file. This most certainly will be zipped so expect to see .fa.gz or .fasta.gz. For the purpose of RNAseq analysis know that FASTA file holds your reference sequence. 2.3.0.3 GTF/GFF These are annotation files There are many different biology / bioinformatics related file formats. You will naturally come across different files formats. It doesn’t matter so much what they are called, i.e what they file extention is, rather what they hold. Essentially all bioinformaticie files are either plain text (a.k.a ASCII) or binnary. Plain text files are “easy” to interface with. Unix/Linux command line provide many great tools that can work with plain text files. To list a few populart and powerful command line tools: grep search for a pattern sed search and replace awk search and replace and more cat look inside cut what the knife would do to bread It is out of the scope of this course to go through any of the tools or command line in general, but if you are going to do any kind of bioinformatics you’ll eventually going to come across these tools. The other file type is binnary, this will requires designated tool for interfacing with the file for example SAM/BAM files have samtools that aid interaction with them. 2.4 Plain text files Given that we know the structure of the file TSV or CSV we can use standard command line tools to get relevant/interesting bits e.g ~$ cut -f1,3,5-6 t.tsv Gene.ID Gene.Name KO3_S3 KO4_S4 ENSMUSG00000051951 Xkr4 0 0 ENSMUSG00000025900 Rp1 0 0 ENSMUSG00000109048 Rp1 0 0 ENSMUSG00000025902 Sox17 0 0 ENSMUSG00000033845 Mrpl15 934 1317 ENSMUSG00000025903 Lypla1 705 848 ENSMUSG00000104217 Gm37988 0 0 ENSMUSG00000033813 Tcea1 354 436 ENSMUSG00000002459 Rgs20 0 0 2.5 Glossary interface: extract or insert relevant information "],
["reference-sequence.html", "3 Reference sequence 3.1 Exercise 3.2 Rule of thumb", " 3 Reference sequence In this course will be focusing on DNA/RNA molecules and hence our sequences will be nucleotides sequences. In the case of Mus_musculus (mouse) genome, we have 19 autosomal chromosomes and two sex chromosomes X and Y plus a mitochondrial chromosome (genome). This makes up 22 separate molecules and therefore 22 separate sequences. Typically that sequence is stored in FASTA file format FASTQ for raw short reads FAST5 for raw long reads FASTA for any other kind of sequence The other possible bioinformatics files that we weren’t focus on are, genbank and gff. Both of those files can hold annotation and sequence information in one file. It often works fine with small genomes, but large eukaryotic genomes are better split into two files reference sequence and annotation information. 3.0.1 FASTA FASTA file typically can hold any type of sequence data. We are not going to talk about amino acid sequence in this course and so for your purpose we can think of FASTA as just holding nucleotides sequence. That sequence can be anything, primer or adapter sequence, individual transcripts (genes) sequence OR entire chromosome sequence. In the case when FASTA holds entire genome, that is all chromosomes for a given species, we tend to refer to that FASTA file as a reference genome file. If I’m asking biologist of a reference genome, I typically imply that I need a FASTA file with genomic sequence. Be aware that there isn’t such thing as “the genome” for a particular species. This is because any genome is a There are a few different fasta files, but all of them will hold some sort of sequence. Sometime you’ll see .fna to inidicate nuclear sequence or .faa to indicate amino acid sequence, but more generally it’ll be .fa or a longer version .fasta. Like any biological plain text file. This most certainly will be zipped so expect to see .fa.gz or .fasta.gz. Note that our purpose we can think of FASTA file holding our reference genome sequence of intereste e.g mouse genome. This is previously assembled genome that was made puplically available. There are several different vendors that provide reference genomes. In general either one of these three will is a good place to start looking for you reference genome. Ensembl RefSeq UCSC genomes Those will have majority of species, however it is common to have a stand along community that host reference genomes from a different place. A good example is yeast genome database. If you are working with yeast this is the place to look for reference genomes. It is important to note that reference genome isn’t a defined sequence. It is simply the best we have so far and it is a continuos effort to improve quality of the genomes. For widely used model organisms like mouse and yeast their genomes have been sequenced and assembled many times over the years and we have very good quality genomes. Species like axolotl or spiny mouse are less commonly used as model organism in comparison to mouse genomes and quality of those genomes is poorer. There are however other factors in place that influence genome quality e.g genome complexety. 3.1 Exercise go to Ensembl website from the drop down on the left hand site select Saccharomyces_cerevisiae, which is a yeast species. click on download FASTA file. This will redirect you to ftp site find file Saccharomyces_cerevisiae.R64-1-1.dna_sm.toplevel.fa.gz and download it by clicking once downloaded double click on the file to open it and view the content. depending on the operating system that you have you might have to unzip fasta file first before opening. It is best not to open with MS Office suite. Use text editor instead. On windows it’ll be notepad on macOS it’ll textmate. At the very top you should see this &gt;I dna_sm:chromosome chromosome:R64-1-1:I:1:230218:1 REF ccacaccacacccacacacccacacaccacaccacacaccacaccacacccacacacaca caTCCTAACACTACCCTAACACAGCCCTAATCTAACCCTGGCCAACCTGTCTCTCAACTT ACCCTCCATTACCCTGCCTCCACTCGTTACCCTGTCCCATTCAACCATACCACTCCGAAC Note the very first line. &gt;I dna_sm:chromosome chromosome:R64-1-1:I:1:230218:1 REF This is a FASTA header that indicates which sequence is follows. In this case it is I i.e sequence from chromosome one of yeast. If there are multiple chromosomes (usually the case for eukaryotic species) then you keep reading the sequence until you hit either the end of the file OR the next “&gt;” sign NOTE the actual sequnce have been truncated &gt;I dna_sm:chromosome chromosome:R64-1-1:I:1:230218:1 REF ccacaccacacccacacacccacacaccacaccacacaccacaccacacccacacacaca caTCCTAACACTACCCTAACACAGCCCTAATCTAACCCTGGCCAACCTGTCTCTCAACTT ACCCTCCATTACCCTGCCTCCACTCGTTACCCTGTCCCATTCAACCATACCACTCCGAAC &gt;II dna_sm:chromosome chromosome:R64-1-1:II:1:813184:1 REF CCCACACACCACACCCACACCACACCCACACACCACACACACCACACCCACACACCCACA CCACACCACACCCACACCACACCCACACACCCACACCCACACACCACACCCACACACACC ACACCCACACACACCCACACCCACACACCACACCCACACACACACCACACCCACACACAC CACACCACACCCACACCACACCCACACCCACACACCACACCCACACCCACACCCCACACC The format of the FASTA header is rather loosely defined, but these are key points: must start with “&gt;” sign the contig/chromsome name follows straight after “&gt;” sign. Can be any string anything after a space is a comment/description Below are all valid FASTA headers &gt;I &gt;chrI &gt;NC_000067.6 &gt;I_named_it Each header in a single FASTA file has to be uqniue in order to identify each sequence. Are this two FASTA header the same? &gt;I &gt;I named it Are this two FASTA header unique? &gt;I &gt;I_named_it While this apper to be very are small details, the reason it is important because you want to know which chromosome (molecule) your reads came from. 3.2 Rule of thumb Unless you are working with some exotic species and/or have a strong prefernce for genome vendor you can generally leave this part up to your bioinformatician to sort out. It is important to know that there are different vendors that have different versions (builds) of genomes. . Often times bacterial RNAseq data come with some custome reference and annotation files. If that happens bioinformatician will need to convert everythign to FASTA and GTF/GFF files. "],
["all-about-rnaseq.html", "4 All about RNAseq 4.1 General 4.2 Technology 4.3 Differential expression (DE)", " 4 All about RNAseq 4.1 General Functional annotation of the mouse (FANTOM) Encyclopedia of DNA elements (ENCODE) Single loci can lead to to six different mRNA isoforms, on average, instead of single transcript 4.2 Technology What is it for? what is expressed (exon locatios /strand) ? how much is expressed (hits per transcripts) ? old way to do DE - microarray do need as much starting material for RNAseq Noise: biological poisson noise from samplinig (have level of uncertanty at low level, low counts) technical Effect size (do the genes go up by alot or not - high signal) amount of variation get better depth using poly-A enriched, because rRNA depletion will leave lots of other RNA around therefore diluting mRNA by some percent mean fragment size ~ 300 bp measure of uncertanty of the base call 4.3 Differential expression (DE) library size is total number of mapped reads. Library size might vary for individual samples. Total number of reads per gene proportional to: gene expression level (to get cpm (count per million) divide each read count by library size multiplied by million). This is enable you to compare different library sized samples transcript length sequencing depth of the library # Ideas have a url with multiqc report ready for browsing explain reference file (FASTA) and annotation files (GTF) "],
["lesson-plan.html", "5 Lesson plan", " 5 Lesson plan Perhaps it’ll be good idea to introduce several different plain text files txt csv/tsv gff/gff3/gtf fastq/fq fasta/fa/faa/fna DO NOT unzip your fastq file and store them as plain text ! DO NOT mess with your raw fastq files! "],
["meeting-notes.html", "6 Meeting notes", " 6 Meeting notes This is overall them of the day How to instruct them to be good RNAseq user? have a url with multiqc page ready? This is explain reference file (FASTA) and annotation files (GTF) This if you can set up ftp link so that users can pont and click through directory structure to interact with the sikRun output. Mentione salmon Good to mention in parsing - salmon if you are using salmon you not going to see DNA contamination. so something to be aware. Also mentione that this is for model organism that are well annotation/assembled. Use Chiara’s data to study chromosome 21. From multiqc report chromosome 21 has a lot more reads. It looks like ribosomal contamination even though library was polyA pooled. Take all reads from chr21 and do feature counts and look where reads go. Suspecting that reads go to ribosomal genes. If so this would be great case study for the workshop. https://www.ncbi.nlm.nih.gov/pubmed/29788454 genotify Reproducible research using the same reference files TCGA for example is using a single reference for the whole cohort If you gonna do second study e.g chipSeq you gotta have it on the same reference as your RNAseq there is no such thing as “the reference genome” there are different builds, it is work in progress "]
]
